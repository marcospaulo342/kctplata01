# üìõ Bloquear acesso a arquivos sens√≠veis
<FilesMatch "^(\.env|\.git|composer\.json|composer\.lock|package\.json|yarn\.lock|.*\.zip)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# üîí Bloquear execu√ß√£o de PHP em pastas espec√≠ficas (ajuste se necess√°rio)
# Em vez de usar <Directory>, use condi√ß√µes baseadas em caminho
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Desabilitar PHP no diret√≥rio /db
    RewriteCond %{REQUEST_URI} ^/db/.*\.php$ [NC]
    RewriteRule .* - [F]
    
    # Desabilitar PHP no diret√≥rio /verificacoes
    RewriteCond %{REQUEST_URI} ^/verificacoes/.*\.php$ [NC]
    RewriteRule .* - [F]
</IfModule>

# üîê Bloquear acesso direto a qualquer arquivo PHP que contenha "credenciais" no nome
<FilesMatch "credenciais\.php">
    Order allow,deny
    Deny from all
</FilesMatch>

# üßæ Impedir listagem de diret√≥rio
Options -Indexes

# ‚ö†Ô∏è Se estiver usando Apache 2.4+
<IfModule mod_authz_core.c>
    <FilesMatch "^(\.env|\.git|composer\.json|composer\.lock|package\.json|yarn\.lock|.*\.zip|credenciais\.php)$">
        Require all denied
    </FilesMatch>
</IfModule>

# üõ°Ô∏è Prote√ß√£o b√°sica contra inje√ß√µes
<IfModule mod_rewrite.c>
    RewriteEngine On

    # Bloquear tentativas de acesso com "../"
    RewriteCond %{REQUEST_URI} \.\.\/ [NC]
    RewriteRule .* - [F]

    # Bloquear arquivos com extens√£o dupla maliciosa (ex: .php.jpg)
    RewriteRule \.(php|php5|phtml)\.(jpg|jpeg|png|gif|bmp)$ - [F,NC]
</IfModule>

# Alternativa para proteger arquivos PHP em diret√≥rios espec√≠ficos
# Voc√™ pode usar .htaccess separados dentro de cada diret√≥rio
# Ou usar a seguinte abordagem para o diret√≥rio atual:
<FilesMatch "\.php$">
    # Verificar se o arquivo est√° em um diret√≥rio protegido
    SetEnvIf Request_URI "^/db/" PROTECTED_DIR
    SetEnvIf Request_URI "^/verificacoes/" PROTECTED_DIR
    SetEnvIf Request_URI "^/views/" PROTECTED_DIR
    
    # Negar acesso aos arquivos PHP nos diret√≥rios protegidos
    Order allow,deny
    Deny from env=PROTECTED_DIR
    Allow from all
</FilesMatch>